# –£—Ä–æ–∫ 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ testTag –∏ —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–¥–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –¶–µ–ª—å

–ù–∞—É—á–∏—Ç—å—Å—è —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É **–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ `testTag`**: –Ω–∞—Ö–æ–¥–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–µ–≥, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ –æ–±—ä–µ–∫—Ç–µ `Tags`, –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ç–µ—Å—Ç–µ.

---

## –ö–∞–∫ testTag –∑–∞–¥–∞—ë—Ç—Å—è –≤ –∫–æ–¥–µ

–í –ø—Ä–µ–¥—ã–¥—É—â–µ–º —É—Ä–æ–∫–µ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `testTag` –¥–ª—è –ø–æ–∏—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–æ –Ω–µ –∑–∞–≥–ª—è–¥—ã–≤–∞–ª–∏ ¬´–ø–æ–¥ –∫–∞–ø–æ—Ç¬ª. –¢–µ–ø–µ—Ä—å —Ä–∞–∑–±–µ—Ä—ë–º—Å—è, –∫–∞–∫ —Ç–µ–≥–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ.

### Modifier.semantics

–í Compose —Ç–µ–≥ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä `Modifier.semantics`:

```kotlin
// –í –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, AvatarSelectScreen.kt):
Button(
    onClick = { /* ... */ },
    modifier = Modifier
        .fillMaxWidth()
        .semantics { testTag = Tags.AVATAR_NEXT_BUTTON }
) {
    Text("–î–∞–ª–µ–µ")
}
```

### Modifier.testTag ‚Äî –∫—Ä–∞—Ç–∫–∞—è –∑–∞–ø–∏—Å—å

–ï—Å—Ç—å –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π —Å–ø–æ—Å–æ–± ‚Äî `Modifier.testTag(tag)`:

```kotlin
modifier = Modifier
    .fillMaxWidth()
    .testTag(Tags.AVATAR_NEXT_BUTTON)
```

> [!TIP]
> `Modifier.testTag(tag)` ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª—è `Modifier.semantics { testTag = tag }`. –û–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω—è—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ.

### –û–±—ä–µ–∫—Ç Tags ‚Äî –µ–¥–∏–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤

–í –Ω–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –≤—Å–µ —Ç–µ–≥–∏ —Å–æ–±—Ä–∞–Ω—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ ‚Äî –æ–±—ä–µ–∫—Ç–µ `Tags` (—Ñ–∞–π–ª `Tags.kt`):

```kotlin
object Tags {
    // Avatar Select Screen
    const val AVATAR_CONTAINER = "avatar_screen_container"
    const val AVATAR_ICON = "avatar_icon"                   // + "_$index"
    const val AVATAR_NEXT_BUTTON = "avatar_screen_next_button"
    const val AVATAR_ERROR = "avatar_screen_error_text"

    // Name Input Screen
    const val NAME_CONTAINER = "name_input_screen_container"
    const val NAME_EDIT_TITLE = "name_input_screen_title"
    const val NAME_EDIT_TEXT = "name_input_screen_edit_text"
    // Login button ‚Äî NO TAG (–¥–ª—è –æ–±—É—á–µ–Ω–∏—è)
    // ...
}
```

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –¥–∞—ë—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤:
- **–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ** –≤ IDE ‚Äî –Ω–µ –Ω—É–∂–Ω–æ –≤—Å–ø–æ–º–∏–Ω–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤—Ä—É—á–Ω—É—é
- **–ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã** ‚Äî –µ—Å–ª–∏ —Ç–µ–≥ –∏–∑–º–µ–Ω–∏—Ç—Å—è, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å –æ–¥–Ω—É –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É
- **–ü–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É** ‚Äî –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏, –≥–¥–µ —Ç–µ–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–≤ UI-–∫–æ–¥–µ –∏ –≤ —Ç–µ—Å—Ç–∞—Ö)

---

## –ü—Ä–æ–±–ª–µ–º–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–µ–≥–∞

### –ü–æ—á–µ–º—É —Ç–µ–≥–æ–≤ –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å

–ù–µ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏–º–µ—é—Ç `testTag`. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ —Ä–∞–∑–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º:
- –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ **–∑–∞–±—ã–ª** –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥ –∏–ª–∏ —ç—Ç–æ –Ω–µ –ø—Ä–∏–Ω—è—Ç–æ –Ω–∞ –ø—Ä–æ–µ–∫—Ç–µ
- –≠–ª–µ–º–µ–Ω—Ç –¥–æ–±–∞–≤–ª–µ–Ω **–Ω–µ–¥–∞–≤–Ω–æ** –∏ –µ—â—ë –Ω–µ –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏
- –¢–µ–≥ **–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω** ‚Äî —Å—á–∏—Ç–∞–µ—Ç—Å—è, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω—É–∂–µ–Ω –≤ —Ç–µ—Å—Ç–∞—Ö

–í –Ω–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –∫–Ω–æ–ø–∫–∞ ¬´–í–æ–π—Ç–∏¬ª –Ω–∞ —ç–∫—Ä–∞–Ω–µ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ **–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ** –Ω–µ –∏–º–µ–µ—Ç —Ç–µ–≥–∞:

```kotlin
// NameInputScreen.kt ‚Äî –∫–Ω–æ–ø–∫–∞ –ë–ï–ó —Ç–µ–≥–∞
Button(
    onClick = { /* ... */ },
    modifier = Modifier.fillMaxWidth()   // ‚Üê –Ω–µ—Ç .semantics { testTag = ... }
) {
    Text("–í–æ–π—Ç–∏")
}
```

### –ü–æ—á–µ–º—É –ø–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É ‚Äî —Ö—Ä—É–ø–∫–∏–π —Å–ø–æ—Å–æ–±

–ë–µ–∑ —Ç–µ–≥–∞ –Ω–∞–π—Ç–∏ –∫–Ω–æ–ø–∫—É –º–æ–∂–Ω–æ –ø–æ —Ç–µ–∫—Å—Ç—É: `onNodeWithText("–í–æ–π—Ç–∏")`. –ù–æ —ç—Ç–æ **–Ω–µ–Ω–∞–¥—ë–∂–Ω–æ**:

- –¢–µ–∫—Å—Ç –º–æ–∂–µ—Ç **–∏–∑–º–µ–Ω–∏—Ç—å—Å—è** –ø—Ä–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ —Ä–µ–¥–∏–∑–∞–π–Ω–µ
- –ù–∞ —ç–∫—Ä–∞–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤** —Å —Ç–∞–∫–∏–º —Ç–µ–∫—Å—Ç–æ–º
- –¢–µ—Å—Ç **–ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ UI**, –∞ –Ω–µ –∫ –µ–≥–æ —Å–º—ã—Å–ª–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

> [!IMPORTANT]
> –í —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —á–∞—Å—Ç–æ –∑–∞–±—ã–≤–∞—é—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–µ–≥–∏. –ó–∞–¥–∞—á–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ç–æ—Ä–∞ ‚Äî **–∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–æ–≤** —á–µ—Ä–µ–∑ merge/pull request –∏–ª–∏ **–¥–æ–±–∞–≤–ª—è—Ç—å –∏—Ö —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ**, –µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–¥—É.

### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å testTag ‚Äî –ø–æ—à–∞–≥–æ–≤–æ

1. **–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É** –≤ `Tags.kt`:

```kotlin
object Tags {
    // ...
    const val NAME_EDIT_BUTTON = "name_input_login_button"
}
```

2. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥ –∫ —ç–ª–µ–º–µ–Ω—Ç—É** –≤ Compose-–∫–æ–¥–µ (`NameInputScreen.kt`):

```kotlin
Button(
    onClick = { /* ... */ },
    modifier = Modifier
        .fillMaxWidth()
        .testTag(Tags.NAME_EDIT_BUTTON)  // ‚Üê –¥–æ–±–∞–≤–∏–ª–∏!
) {
    Text("–í–æ–π—Ç–∏")
}
```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ç–µ—Å—Ç–µ**:

```kotlin
composeTestRule
    .onNodeWithTag(Tags.NAME_EDIT_BUTTON)
    .assertIsDisplayed()
    .performClick()
```

## –ó–∞–¥–∞–Ω–∏–µ: –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –ª–æ–≥–∏–Ω–∞

–ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç `LoginFlowTest.kt`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫—Ä—ã–≤–∞–µ—Ç **–ø–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π** –æ—Ç –≤—ã–±–æ—Ä–∞ –∞–≤–∞—Ç–∞—Ä–∞ –¥–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–µ–Ω—Ç—ã.

### –®–∞–≥ 0 ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–¥–∞

–ü—Ä–µ–∂–¥–µ —á–µ–º –ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç, –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π —Ç–µ–≥:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `Tags.kt` –∏ –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É `NAME_LOGIN_BUTTON = "name_input_login_button"`
2. –û—Ç–∫—Ä–æ–π—Ç–µ `NameInputScreen.kt`, –Ω–∞–π–¥–∏—Ç–µ –∫–Ω–æ–ø–∫—É ¬´–í–æ–π—Ç–∏¬ª –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ç–µ–≥ —á–µ—Ä–µ–∑ `Modifier.testTag`

### –®–∞–≥–∏ —Ç–µ—Å—Ç–∞

**–®–∞–≥–∏:**
1. –í—ã–±—Ä–∞—Ç—å –∞–≤–∞—Ç–∞—Ä
2. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É ¬´–î–∞–ª–µ–µ¬ª
3. –í–≤–µ—Å—Ç–∏ –∏–º—è ¬´–¢–µ—Å—Ç–µ—Ä¬ª –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
4. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É ¬´–í–æ–π—Ç–∏¬ª –ø–æ **–Ω–æ–≤–æ–º—É** —Ç–µ–≥—É

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û—Ç–∫—Ä—ã–ª–∞—Å—å –ª–µ–Ω—Ç–∞ ‚Äî –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç ¬´–ü—Ä–∏–≤–µ—Ç, –¢–µ—Å—Ç–µ—Ä!¬ª
- –í –ª–µ–Ω—Ç–µ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ø–æ—Å—Ç ‚Äî `feed_post_0` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

---

## –ü–æ–¥—Å–∫–∞–∑–∫–∏

<details>
<summary>–ü–æ–¥—Å–∫–∞–∑–∫–∞: –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ –≤ –ø–æ–ª–µ</summary>

–î–ª—è –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `performTextInput`:

```kotlin
composeTestRule
    .onNodeWithTag(Tags.NAME_EDIT_TEXT)
    .assertIsDisplayed()
    .performTextInput("–¢–µ—Å—Ç–µ—Ä")
```

> [!TIP]
> `performTextInput` –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –∫ —Ç–µ–∫—É—â–µ–º—É —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –ø–æ–ª—è. –ï—Å–ª–∏ –ø–æ–ª–µ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `performTextClearance()` –ø–µ—Ä–µ–¥ –≤–≤–æ–¥–æ–º.

</details>


<details>
<summary>–ü–æ–¥—Å–∫–∞–∑–∫–∞: –°–∫–µ–ª–µ—Ç —Ç–µ—Å—Ç–∞</summary>

```kotlin
class LoginFlowTest : TestCase() {

    @get:Rule
    val composeTestRule = createAndroidComposeRule<MainActivity>()

    @Test
    fun loginToFeed() = run {
        step("–í—ã–±—Ä–∞—Ç—å –∞–≤–∞—Ç–∞—Ä") {
            \\...
        }

        step("–ù–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É ¬´–î–∞–ª–µ–µ¬ª") {
            \\...
        }

        step("–í–≤–µ—Å—Ç–∏ –∏–º—è ¬´–¢–µ—Å—Ç–µ—Ä¬ª –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞") {
            \\...
        }

        step("–ù–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É ¬´–í–æ–π—Ç–∏¬ª") {
            \\...
        }

        step("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫-–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ª–µ–Ω—Ç—ã") {
             \\...
        }

        step("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å—Ç–∞") {
            \\...
        }
    }
}
```

</details>

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é Compose](https://developer.android.com/develop/ui/compose/testing/testing-cheatsheet?hl=ru)