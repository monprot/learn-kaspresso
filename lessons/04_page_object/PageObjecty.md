# –£—Ä–æ–∫ 4. Page Object –∏ Screen-Steps Pattern

## –¶–µ–ª—å

–ü–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º **Page Object** –∏ –µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏–µ–º ‚Äî –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º **Steps**. –ù–∞—É—á–∏—Ç—å—Å—è —Ä–∞–∑–¥–µ–ª—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —ç–∫—Ä–∞–Ω–∞ –∏ –ª–æ–≥–∏–∫—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –Ω–∏–º. –ê —Ç–∞–∫ –∂–µ —Å—Ä–∞–∑—É –Ω–∞—á–∞—Ç—å –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ñ–∏—à–∫–∏ Kaspresso –∏ Kakao Compose —É–ø—Ä–æ—â–∞—é—â–∏–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤.

---

> [!NOTE]
> –ù–∞–±–æ—Ä –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è –æ—Ç –ø—Ä–æ–µ–∫—Ç–∞ –∫ –ø—Ä–æ–µ–∫—Ç—É, –Ω–æ PageObject –≤ —Ç–æ–º –∏–ª–∏ –∏–Ω–æ–º –≤–∏–¥–µ –≤—ã –≤—Å—Ç—Ä–µ—Ç–∏—Ç–µ –Ω–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –∏–∑ –Ω–∏—Ö.

## –ß–∞—Å—Ç—å 1. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Page Object

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Page Object

–í –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É—Ä–æ–∫–∞—Ö –≤—ã –≤–∏–¥–µ–ª–∏, –∫–∞–∫ —Ç–µ—Å—Ç—ã –æ–±—Ä–∞—Å—Ç–∞—é—Ç –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏. –í—ã–±–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ ID –∏–ª–∏ —Ç–µ–≥—É —Ä–∞–∑–±—Ä–æ—Å–∞–Ω –ø–æ –≤—Å–µ–º —Ç–µ—Å—Ç–∞–º. –ï—Å–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–º–µ–Ω—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç, –≤–∞–º –ø—Ä–∏–¥—ë—Ç—Å—è –ø—Ä–∞–≤–∏—Ç—å –µ–≥–æ –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö. –ß–µ–º –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤ ‚Äî —Ç–µ–º –±–æ–ª—å—à–µ –º–µ—Å—Ç –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏ —Ç–µ–º –≤—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—à–∏–±–∫–∏.

**Page Object** —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É. –≠—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —ç–∫—Ä–∞–Ω (–∏–ª–∏ –µ–≥–æ —á–∞—Å—Ç—å) –∏ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã (–ú–∞—Ä—Ç–∏–Ω –§–∞—É–ª–µ—Ä)

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.** –¢–µ—Å—Ç –≥–æ–≤–æ—Ä–∏—Ç **—á—Ç–æ** –¥–µ–ª–∞—Ç—å (—Å—Ü–µ–Ω–∞—Ä–∏–π), –∞ Page Object –∑–Ω–∞–µ—Ç **–∫–∞–∫** —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å (–Ω–∞–π—Ç–∏ –∫–Ω–æ–ø–∫—É, –Ω–∞–∂–∞—Ç—å).
2. **–û–¥–∏–Ω —ç–∫—Ä–∞–Ω = –û–¥–∏–Ω –∫–ª–∞—Å—Å.**
3. **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –ª–æ–∫–∞—Ç–æ—Ä–æ–≤.** –¢–µ–≥–∏ –∏ ID —Å–∫—Ä—ã—Ç—ã –≤–Ω—É—Ç—Ä–∏ Page Object. –ù–∞—Ä—É–∂—É —Ç–æ—Ä—á–∞—Ç —Ç–æ–ª—å–∫–æ –ø–æ–Ω—è—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã.
4. **–ú–µ—Ç–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç Page Object.** –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å —Ü–µ–ø–æ—á–∫–∏ (`loginPage.enterName().clickLogin()`).

### –ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç

| –ë–µ–∑ Page Object | –° Page Object |
|---|---|
| –¢–µ–≥ `"avatar_screen_next_button"` –≤ 15 —Ç–µ—Å—Ç–∞—Ö | –¢–µ–≥ –≤ **–æ–¥–Ω–æ–º** –º–µ—Å—Ç–µ ‚Äî `AvatarSelectScreen.nextButton` |
| –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–≥–∞ ‚Üí –ø—Ä–∞–≤–∫–∏ –≤ 15 —Ñ–∞–π–ª–∞—Ö | –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–≥–∞ ‚Üí –ø—Ä–∞–≤–∫–∞ –≤ **–æ–¥–Ω–æ–º** —Ñ–∞–π–ª–µ |
| –¢–µ—Å—Ç: `onNodeWithTag("avatar_screen_next_button")` ‚Äî —á—Ç–æ —ç—Ç–æ? | –¢–µ—Å—Ç: `nextButton { assertIsDisplayed() }` ‚Äî —Å—Ä–∞–∑—É –ø–æ–Ω—è—Ç–Ω–æ |
| –ù–æ–≤—ã–π —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫: ¬´—á—Ç–æ –∑–∞ —Å—Ç—Ä–æ–∫–∞?¬ª | –ù–æ–≤—ã–π —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫: ¬´–∞, –∫–Ω–æ–ø–∫–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –∞–≤–∞—Ç–∞—Ä–∞¬ª |

–í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–º Page Object –º–µ—Ç–æ–¥—ã –æ–±—ä–µ–∫—Ç–∞ **–Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç assertions** (–ø—Ä–æ–≤–µ—Ä–æ–∫). –û–Ω–∏ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–ª–∏ –¥—Ä—É–≥–∏–µ Page Object-—ã. –ü—Ä–æ–≤–µ—Ä–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Ç–µ—Å—Ç–µ.

---

## –ß–∞—Å—Ç—å 2. Kaspresso: ComposeScreen –∏ KNode

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Kakao Compose

Kaspresso –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É [Kakao Compose](https://github.com/KakaoCup/Compose) –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è Page Object-–æ–≤. –ï—ë –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

- **`ComposeScreen`** ‚Äî –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è Page Object (–∞–Ω–∞–ª–æ–≥ ¬´—ç–∫—Ä–∞–Ω–∞¬ª)
- **`KNode`** ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤–Ω—É—Ç—Ä–∏ —ç–∫—Ä–∞–Ω–∞ (–∫–Ω–æ–ø–∫–∞, –ø–æ–ª–µ, —Ç–µ–∫—Å—Ç –∏ —Ç.–¥.)
- **`onComposeScreen`** ‚Äî DSL-—Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç–∫—Ä–∞–Ω–æ–º –≤–Ω—É—Ç—Ä–∏ —Ç–µ—Å—Ç–∞

### –°–æ–∑–¥–∞–Ω–∏–µ ComposeScreen

–ö–∞–∂–¥—ã–π —ç–∫—Ä–∞–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –∫–ª–∞—Å—Å, –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π `ComposeScreen`:

```kotlin
class AvatarSelectScreen(semanticsProvider: SemanticsNodeInteractionsProvider) :
    ComposeScreen<AvatarSelectScreen>(semanticsProvider = semanticsProvider) {

    val nextButton: KNode = child {
        hasTestTag(Tags.AVATAR_NEXT_BUTTON)
    }

    fun avatar(index: Int): KNode = child {
        hasTestTag("${Tags.AVATAR_ICON}_$index")
    }
}
```

–†–∞–∑–±–µ—Ä—ë–º –ø–æ —á–∞—Å—Ç—è–º:

- `semanticsProvider` ‚Äî –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∫–æ–≥–¥–∞ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `onComposeScreen`
- `ComposeScreen<AvatarSelectScreen>` ‚Äî –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —Å —Ç–∏–ø–æ–≤—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º (—Å–∞–º–æ—Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏—è)
- `child { ... }` ‚Äî –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–∞–∫ **–¥–æ—á–µ—Ä–Ω–µ–≥–æ —É–∑–ª–∞** —ç–∫—Ä–∞–Ω–∞
- `hasTestTag(...)` ‚Äî –º–∞—Ç—á–µ—Ä –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–∑–ª–∞ –ø–æ `testTag`

–í —Ç–µ—Å—Ç–µ:
```kotlin
onComposeScreen<AvatarSelectScreen>(composeTestRule) {
    nextButton.performClick()
}
```

### KNode ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞

`KNode` ‚Äî —ç—Ç–æ ¬´–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç¬ª –Ω–∞ —ç–∫—Ä–∞–Ω–µ. –û–Ω –Ω–µ –∏—â–µ—Ç —É–∑–µ–ª –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏, –∞ —Ö—Ä–∞–Ω–∏—Ç **–Ω–∞–±–æ—Ä –º–∞—Ç—á–µ—Ä–æ–≤** –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ (assertion –∏–ª–∏ action).


–ú–∞—Ç—á–µ—Ä—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å–æ [—à–ø–∞—Ä–≥–∞–ª–∫–æ–π](https://developer.android.com/develop/ui/compose/testing/testing-cheatsheet?hl=ru), –∞ –µ—â–µ –∏—Ö –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å:

```kotlin
val loginButton: KNode = child {
    hasTestTag(Tags.NAME_INPUT_LOGIN_BUTTON)
    hasText("–í–æ–π—Ç–∏")
}
```

### viewBuilderAction ‚Äî –ø—Ä–∏–≤—è–∑–∫–∞ —ç–∫—Ä–∞–Ω–∞ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É

–ï—Å–ª–∏ —ç–∫—Ä–∞–Ω –∏–º–µ–µ—Ç —Å–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —Ç–µ–≥–æ–º, –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –µ–≥–æ —á–µ—Ä–µ–∑ `viewBuilderAction`. –¢–æ–≥–¥–∞ –≤—Å–µ `child`-—ç–ª–µ–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –∏—Å–∫–∞—Ç—å—Å—è **—Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏** —ç—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```kotlin
class AvatarSelectScreen(semanticsProvider: SemanticsNodeInteractionsProvider) :
    ComposeScreen<AvatarSelectScreen>(
        semanticsProvider = semanticsProvider,
        viewBuilderAction = { hasTestTag(Tags.AVATAR_CONTAINER) }
    ) {
    // nextButton –∏—â–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ avatar_screen_container
    val nextButton: KNode = child {
        hasTestTag(Tags.AVATAR_NEXT_BUTTON)
    }
}
```

> [!TIP]
> `viewBuilderAction` ‚Äî –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä. –ï—Å–ª–∏ —ç–∫—Ä–∞–Ω ‚Äî —ç—Ç–æ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –º–æ–∂–Ω–æ –µ–≥–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å.

### KakaoComposeTestRule ‚Äî —ç–∫—Ä–∞–Ω—ã –±–µ–∑ boilerplate

–í–æ–∑–º–æ–∂–Ω–æ –≤—ã –∑–∞–º–µ—Ç–∏–ª–∏, —á—Ç–æ –≤ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ `onComposeScreen` –º—ã –ø–µ—Ä–µ–¥–∞—ë–º `composeTestRule`:

```kotlin
onComposeScreen<AvatarSelectScreen>(composeTestRule) {
    nextButton.performClick()
}
```

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Kakao Compose –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç **`KakaoComposeTestRule`** ‚Äî JUnit-–ø—Ä–∞–≤–∏–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç `composeTestRule` **–≥–ª–æ–±–∞–ª—å–Ω–æ**. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ:

1. **`onComposeScreen` –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç–∞** ‚Äî –ø—Ä–∞–≤–∏–ª–æ —Å–∞–º–æ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç `semanticsProvider`
2. **–≠–∫—Ä–∞–Ω—ã –º–æ–∂–Ω–æ –æ–±—ä—è–≤–ª—è—Ç—å –∫–∞–∫ `object`** ‚Äî –Ω–µ –Ω—É–∂–µ–Ω –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å `semanticsProvider`
3. **`onComposeScreen` –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∏–º—è –æ–±—ä–µ–∫—Ç–∞** ‚Äî `AvatarSelectScreen { ... }`

#### Screen –∫–∞–∫ object

–î–æ:
```kotlin
class AvatarSelectScreen(semanticsProvider: SemanticsNodeInteractionsProvider) :
    ComposeScreen<AvatarSelectScreen>(semanticsProvider = semanticsProvider) {
    // ...
}
```

–ü–æ—Å–ª–µ:
```kotlin
object AvatarSelectScreen : ComposeScreen<AvatarSelectScreen>() {
    // ...
}
```

#### –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –≤ —Ç–µ—Å—Ç–µ

```kotlin
class AvatarSelectScreenTest : BaseTestCase() {

    @Test
    fun checkAvatarScreen() = run {
        step("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è 4 –∏–∫–æ–Ω–∫–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤") {
            for (i in 0..3) {
                AvatarSelectScreen.avatar(i).assertIsDisplayed()
            }
        }

        step("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ ¬´–î–∞–ª–µ–µ¬ª –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è") {
            AvatarSelectScreen.nextButton.assertIsDisplayed()
        }
    }

    @Test
    fun checkAvatarError() = run {
        step("–ù–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É '–î–∞–ª–µ–µ'") {
            AvatarSelectScreen.nextButton {
                assertIsDisplayed()
                performClick()
            }
        }

        step("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–∫–∏") {
            AvatarSelectScreen.error {
                assertIsDisplayed()
                assertTextEquals("–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä!")
            }
        }
    }
}
```
--- 

## –ß–∞—Å—Ç—å 3. –ü–∞—Ç—Ç–µ—Ä–Ω Steps

–ù–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö —á–∞—Å—Ç–æ –∏–¥—É—Ç –¥–∞–ª—å—à–µ –∏ —Ä–∞–∑–¥–µ–ª—è—é—Ç **–≠–ª–µ–º–µ–Ω—Ç—ã** –∏ **–õ–æ–≥–∏–∫—É**.

–ï—Å–ª–∏ –º—ã –Ω–∞–ø–∏—à–µ–º `performClick()` –∏ `assertIsDisplayed()` –ø—Ä—è–º–æ –≤ –∫–ª–∞—Å—Å–µ —ç–∫—Ä–∞–Ω–∞, –æ–Ω —Å—Ç–∞–Ω–µ—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º –∏ –±—É–¥–µ—Ç —Å–º–µ—à–∏–≤–∞—Ç—å "—á—Ç–æ –Ω–∞ —ç–∫—Ä–∞–Ω–µ" —Å "—á—Ç–æ –º—ã —Å –Ω–∏–º –¥–µ–ª–∞–µ–º".

–ü–æ—ç—Ç–æ–º—É –≤—ã–¥–µ–ª—è—é—Ç **Test Steps** (—à–∞–≥–∏ —Ç–µ—Å—Ç–∞) –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞

1. **Screen (–≠–∫—Ä–∞–Ω)** ‚Äî –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞ **–ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤**. –•—Ä–∞–Ω–∏—Ç KNode –∏ –ª–æ–∫–∞—Ç–æ—Ä—ã.
2. **Steps (–®–∞–≥–∏)** ‚Äî –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ **–¥–µ–π—Å—Ç–≤–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏**. –ò—Å–ø–æ–ª—å–∑—É—é—Ç Screen –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º.

> [!NOTE]
> –≠—Ç–æ –ª–∏—à—å –æ–¥–∏–Ω –∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞. –ù–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö —á–∞—Å—Ç–æ –ø–∏—à—É—Ç –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä—è–º–æ –≤ Page Object –∏–ª–∏ –¥–∞–∂–µ –≤ —Ç–µ—Å—Ç–µ. –ù–æ –ø–æ–¥—Ö–æ–¥ Steps –¥–µ–ª–∞–µ—Ç —Ç–µ—Å—Ç—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —á–∏—Ç–∞–µ–º—ã–º–∏ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏.

### –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: AvatarSelectSteps

–°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç `AvatarSelectSteps`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–æ–¥—ã-–¥–µ–π—Å—Ç–≤–∏—è:

```kotlin
object AvatarSelectSteps {

    fun selectAvatar(index: Int) {
        AvatarSelectScreen {
            with(avatar(index)) {
                assertIsDisplayed()
                performClick()
            }
        }
    }

    fun clickNextBtn() {
        AvatarSelectScreen {
            nextButton {
                assertIsDisplayed()
                performClick()
            }
        }
    }

    fun assertAvatarDisplayed(index: Int) {
        AvatarSelectScreen {
            avatar(index).assertIsDisplayed()
        }
    }

    fun assertNextButtonDisplayed() {
        AvatarSelectScreen.nextButton.assertIsDisplayed()
    }

    fun assertErrorDisplayed(expectedText: String) {
        AvatarSelectScreen {
            error {
                assertIsDisplayed()
                assertTextEquals(expectedText)
            }
        }
    }
}
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –º–æ–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É—è DSL —Å—Ç–∏–ª—å, —Ç–∞–∫ –∏ —Ç–æ—á–µ—á–Ω—É—é –Ω–æ—Ç–∞—Ü–∏—é. –ü–æ—Å–ª–µ–¥–Ω—è—è —É–¥–æ–±–Ω–µ–π –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –∫–æ–¥ –¥–æ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ `AvatarSelectScreen.nextButton.assertIsDisplayed()`.

---

### –ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–µ—Å—Ç

–¢–µ–ø–µ—Ä—å —Ç–µ—Å—Ç –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ, –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π (`onNode`, `performClick`):

```kotlin
class AvatarSelectScreenTest : BaseTestCase() {

    @Test
    fun checkAvatarScreen() = run {
        step("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è 4 –∏–∫–æ–Ω–∫–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤") {
            for (i in 0..3) {
                AvatarSelectSteps.assertAvatarDisplayed(i)
            }
        }

        step("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ ¬´–î–∞–ª–µ–µ¬ª –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è") {
            AvatarSelectSteps.assertNextButtonDisplayed()
        }
    }

    @Test
    fun checkAvatarError() = run {
        step("–ù–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É '–î–∞–ª–µ–µ'") {
            AvatarSelectSteps.clickNextBtn()
        }

        step("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–∫–∏") {
            AvatarSelectSteps.assertErrorDisplayed("–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä!")
        }
    }
}
```

---

## BaseTestCase

–ß—Ç–æ–±—ã `ComposeScreen` —Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª –∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä—ã (–∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ–≤—Ç–æ—Ä –¥–µ–π—Å—Ç–≤–∏–π), —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Kaspresso.Builder.withComposeSupport()`.


–ú—ã –≤—ã–Ω–µ—Å–ª–∏ —ç—Ç–æ –≤ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `BaseTestCase`:

```kotlin
open class BaseTestCase : TestCase(
    kaspressoBuilder = Kaspresso.Builder.withComposeSupport()
) {

    @get:Rule
    val composeTestRule = createAndroidComposeRule<MainActivity>()

    @get:Rule
    val kakaoComposeTestRule = KakaoComposeTestRule(
        semanticsProvider = composeTestRule
    )
}
```

–¢–µ–ø–µ—Ä—å –≤—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç `BaseTestCase`. –¢–∞–∫ –∂–µ `composeTestRule` –æ–±—ä—è–≤–ª–µ–Ω **–æ–¥–∏–Ω —Ä–∞–∑** –≤ –±–∞–∑–æ–≤–æ–º –∫–ª–∞—Å—Å–µ, –∞ `kakaoComposeTestRule` —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –µ–≥–æ –¥–ª—è –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–æ–≤.


### –ü–æ—á–µ–º—É assertIsDisplayed() –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º

–ò–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Kaspresso:

> –≠–ª–µ–º–µ–Ω—Ç –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–º –¥–µ—Ä–µ–≤–µ, –Ω–æ **—Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ –±—ã—Ç—å –≤–∏–¥–∏–º—ã–º** –Ω–∞ —ç–∫—Ä–∞–Ω–µ. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ `performClick()` —Å—Ä–∞–±–æ—Ç–∞–µ—Ç ¬´–≤ –ø—É—Å—Ç–æ—Ç—É¬ª ‚Äî —Ç–µ—Å—Ç —É–ø–∞–¥—ë—Ç –ø–æ–∑–∂–µ —Å –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ–π –æ—à–∏–±–∫–æ–π.
> 
> –í—ã–∑–æ–≤ `assertIsDisplayed()` –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç **Kaspresso Interceptors**.

> [!IMPORTANT]
> **–í—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–π—Ç–µ `assertIsDisplayed()` –ø–µ—Ä–µ–¥ `performClick()` –∏ –¥—Ä—É–≥–∏–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏.** –≠—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∞, –Ω–æ –∏ —Ç—Ä–∏–≥–≥–µ—Ä –¥–ª—è –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∏ –¥—Ä—É–≥–∏—Ö –∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä–æ–≤ Kaspresso.

---

## –ó–∞–¥–∞–Ω–∏–µ: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Screen-Steps

### –®–∞–≥ 1 ‚Äî –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ç–∫—É

–ú—ã —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω Steps –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ (`AvatarSelectScreen` + `AvatarSelectSteps`).

–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –≤–µ—Ç–∫—É `po-prepared`: 
```bash
git checkout -f po-prepared
```

–ò–∑—É—á–∏—Ç–µ —Ñ–∞–π–ª—ã:
- `screens/AvatarSelectScreen.kt` (—Ç–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç—ã)
- `steps/AvatarSelectSteps.kt` (–¥–µ–π—Å—Ç–≤–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏)
- `tests/AvatarSelectScreenTest.kt` (—Ç–µ—Å—Ç –Ω–∞ —Å—Ç–µ–ø–∞—Ö)

### –®–∞–≥ 2 ‚Äî –°–æ–∑–¥–∞–π—Ç–µ Screen –∏ Steps –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤

–í–∞–º –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤.

1. **NameInput**
   - `screens/NameInputScreen.kt` ‚Äî —ç–ª–µ–º–µ–Ω—Ç—ã
   - `steps/NameInputSteps.kt` ‚Äî –º–µ—Ç–æ–¥—ã

2. **Feed**
   - `screens/FeedScreen.kt` ‚Äî —ç–ª–µ–º–µ–Ω—Ç—ã
   - `steps/FeedSteps.kt` ‚Äî –º–µ—Ç–æ–¥—ã

### –®–∞–≥ 3 ‚Äî –ü–µ—Ä–µ–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ Steps

–ü–µ—Ä–µ–ø–∏—à–∏—Ç–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Ç–µ—Å—Ç—ã —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ç–æ–ª—å–∫–æ Steps-–æ–±—ä–µ–∫—Ç—ã. –í —Å–∞–º–∏—Ö —Ç–µ—Å—Ç–∞—Ö –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∏ –æ–¥–Ω–æ–≥–æ `composeTestRule` –∏–ª–∏ `onNodonNodeWithTag`.

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Page Object ‚Äî Martin Fowler](https://martinfowler.com/bliki/PageObject.html)
- [–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Compose –≤ Kaspresso](https://kasperskylab.github.io/Kaspresso/ru/Wiki/Jetpack_Compose/)
- [Kakao Compose](https://github.com/KakaoCup/Compose)
